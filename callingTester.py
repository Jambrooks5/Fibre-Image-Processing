import CallableMasker
import callableCircleFinder
import simonsMagic
import fromScratch
import CallableGUICapFinder
import CallableGUICapFinder2
import manualCenterFinder
import plotFitting
import fibreAnalyser
import generalFunctions as gf

import numpy as np
import cv2
import matplotlib.pyplot as plt
from datetime import datetime as dt
import statistics as stat
import PIL

import scienceplots

plt.style.use(['science','no-latex'])

t1 = dt.now()

#radPlot = [[0.0, 0.006283185307179587, 0.012566370614359173, 0.01884955592153876, 0.025132741228718346, 0.031415926535897934, 0.03769911184307752, 0.0439822971502571, 0.05026548245743669, 0.05654866776461628, 0.06283185307179587, 0.06911503837897544, 0.07539822368615504, 0.08168140899333463, 0.0879645943005142, 0.09424777960769379, 0.10053096491487339, 0.10681415022205297, 0.11309733552923255, 0.11938052083641214, 0.12566370614359174, 0.13194689145077132, 0.13823007675795088, 0.1445132620651305, 0.15079644737231007, 0.15707963267948966, 0.16336281798666927, 0.16964600329384882, 0.1759291886010284, 0.18221237390820802, 0.18849555921538758, 0.19477874452256716, 0.20106192982974677, 0.20734511513692636, 0.21362830044410594, 0.21991148575128552, 0.2261946710584651, 0.2324778563656447, 0.23876104167282428, 0.24504422698000386, 0.25132741228718347, 0.257610597594363, 0.26389378290154264, 0.2701769682087222, 0.27646015351590175, 0.2827433388230814, 0.289026524130261, 0.29530970943744056, 0.30159289474462014, 0.3078760800517997, 0.3141592653589793, 0.3204424506661589, 0.32672563597333854, 0.33300882128051806, 0.33929200658769765, 0.3455751918948773, 0.3518583772020568, 0.3581415625092364, 0.36442474781641604, 0.37070793312359557, 0.37699111843077515, 0.3832743037379548, 0.3895574890451343, 0.39584067435231396, 0.40212385965949354, 0.40840704496667307, 0.4146902302738527, 0.4209734155810323, 0.4272566008882119, 0.43353978619539146, 0.43982297150257105, 0.44610615680975063, 0.4523893421169302, 0.4586725274241098, 0.4649557127312894, 0.47123889803846897, 0.47752208334564855, 0.48380526865282814, 0.4900884539600077, 0.49637163926718736, 0.5026548245743669, 0.5089380098815465, 0.515221195188726, 0.5215043804959058, 0.5277875658030853, 0.5340707511102648, 0.5403539364174444, 0.546637121724624, 0.5529203070318035, 0.5592034923389833, 0.5654866776461628, 0.5717698629533423, 0.578053048260522, 0.5843362335677015, 0.5906194188748811, 0.5969026041820608, 0.6031857894892403, 0.6094689747964198, 0.6157521601035995, 0.6220353454107791, 0.6283185307179586, 0.6346017160251383, 0.6408849013323178, 0.6471680866394973, 0.6534512719466771, 0.6597344572538566, 0.6660176425610361, 0.6723008278682158, 0.6785840131753953, 0.6848671984825748, 0.6911503837897546, 0.6974335690969341, 0.7037167544041136, 0.7099999397112933, 0.7162831250184728, 0.7225663103256524, 0.7288494956328321, 0.7351326809400116, 0.7414158662471911, 0.7476990515543708, 0.7539822368615503, 0.7602654221687299, 0.7665486074759096, 0.7728317927830891, 0.7791149780902686, 0.7853981633974483, 0.7916813487046279, 0.7979645340118074, 0.8042477193189871, 0.8105309046261666, 0.8168140899333461, 0.8230972752405259, 0.8293804605477054, 0.835663645854885, 0.8419468311620646, 0.8482300164692441, 0.8545132017764238, 0.8607963870836034, 0.8670795723907829, 0.8733627576979625, 0.8796459430051421, 0.8859291283123216, 0.8922123136195013, 0.8984954989266809, 0.9047786842338604, 0.91106186954104, 0.9173450548482196, 0.9236282401553992, 0.9299114254625788, 0.9361946107697584, 0.9424777960769379, 0.9487609813841175, 0.9550441666912971, 0.9613273519984767, 0.9676105373056563, 0.9738937226128359, 0.9801769079200154, 0.986460093227195, 0.9927432785343747, 0.9990264638415542, 1.0053096491487339, 1.0115928344559133, 1.017876019763093, 1.0241592050702726, 1.030442390377452, 1.0367255756846316, 1.0430087609918115, 1.049291946298991, 1.0555751316061706, 1.0618583169133502, 1.0681415022205296, 1.0744246875277093, 1.080707872834889, 1.0869910581420683, 1.093274243449248, 1.0995574287564276, 1.105840614063607, 1.1121237993707869, 1.1184069846779665, 1.124690169985146, 1.1309733552923256, 1.1372565405995052, 1.1435397259066846, 1.1498229112138643, 1.156106096521044, 1.1623892818282233, 1.168672467135403, 1.1749556524425828, 1.1812388377497622, 1.1875220230569419, 1.1938052083641215, 1.200088393671301, 1.2063715789784806, 1.2126547642856602, 1.2189379495928396, 1.2252211349000193, 1.231504320207199, 1.2377875055143783, 1.2440706908215582, 1.2503538761287378, 1.2566370614359172, 1.2629202467430969, 1.2692034320502765, 1.275486617357456, 1.2817698026646356, 1.2880529879718152, 1.2943361732789946, 1.3006193585861743, 1.3069025438933541, 1.3131857292005336, 1.3194689145077132, 1.3257520998148928, 1.3320352851220723, 1.338318470429252, 1.3446016557364315, 1.350884841043611, 1.3571680263507906, 1.3634512116579702, 1.3697343969651496, 1.3760175822723295, 1.3823007675795091, 1.3885839528866886, 1.3948671381938682, 1.4011503235010478, 1.4074335088082273, 1.413716694115407, 1.4199998794225865, 1.426283064729766, 1.4325662500369456, 1.4388494353441252, 1.4451326206513049, 1.4514158059584845, 1.4576989912656642, 1.4639821765728436, 1.4702653618800232, 1.4765485471872029, 1.4828317324943823, 1.489114917801562, 1.4953981031087415, 1.501681288415921, 1.5079644737231006, 1.5142476590302805, 1.5205308443374599, 1.5268140296446395, 1.5330972149518192, 1.5393804002589986, 1.5456635855661782, 1.5519467708733579, 1.5582299561805373, 1.564513141487717, 1.5707963267948966, 1.5770795121020762, 1.5833626974092558, 1.5896458827164355, 1.595929068023615, 1.6022122533307945, 1.6084954386379742, 1.6147786239451536, 1.6210618092523332, 1.6273449945595129, 1.6336281798666923, 1.639911365173872, 1.6461945504810518, 1.6524777357882312, 1.6587609210954108, 1.6650441064025905, 1.67132729170977, 1.6776104770169495, 1.6838936623241292, 1.6901768476313086, 1.6964600329384882, 1.7027432182456679, 1.7090264035528475, 1.7153095888600272, 1.7215927741672068, 1.7278759594743862, 1.7341591447815659, 1.7404423300887455, 1.746725515395925, 1.7530087007031045, 1.7592918860102842, 1.7655750713174636, 1.7718582566246432, 1.778141441931823, 1.7844246272390025, 1.7907078125461822, 1.7969909978533618, 1.8032741831605412, 1.8095573684677209, 1.8158405537749005, 1.82212373908208, 1.8284069243892596, 1.8346901096964392, 1.8409732950036186, 1.8472564803107985, 1.8535396656179781, 1.8598228509251575, 1.8661060362323372, 1.8723892215395168, 1.8786724068466962, 1.8849555921538759, 1.8912387774610555, 1.897521962768235, 1.9038051480754146, 1.9100883333825942, 1.9163715186897738, 1.9226547039969535, 1.9289378893041331, 1.9352210746113125, 1.9415042599184922, 1.9477874452256718, 1.9540706305328512, 1.9603538158400309, 1.9666370011472105, 1.97292018645439, 1.9792033717615698, 1.9854865570687494, 1.9917697423759289, 1.9980529276831085, 2.004336112990288, 2.0106192982974678, 2.016902483604647, 2.0231856689118266, 2.0294688542190062, 2.035752039526186, 2.0420352248333655, 2.048318410140545, 2.054601595447725, 2.060884780754904, 2.067167966062084, 2.0734511513692633, 2.079734336676443, 2.086017521983623, 2.092300707290802, 2.098583892597982, 2.1048670779051615, 2.111150263212341, 2.1174334485195203, 2.1237166338267004, 2.1299998191338796, 2.1362830044410592, 2.142566189748239, 2.1488493750554185, 2.155132560362598, 2.161415745669778, 2.1676989309769574, 2.1739821162841366, 2.1802653015913167, 2.186548486898496, 2.1928316722056755, 2.199114857512855, 2.205398042820035, 2.211681228127214, 2.217964413434394, 2.2242475987415737, 2.230530784048753, 2.236813969355933, 2.243097154663112, 2.249380339970292, 2.2556635252774715, 2.261946710584651, 2.2682298958918303, 2.2745130811990104, 2.28079626650619, 2.2870794518133692, 2.2933626371205493, 2.2996458224277285, 2.305929007734908, 2.312212193042088, 2.3184953783492674, 2.3247785636564466, 2.3310617489636267, 2.337344934270806, 2.3436281195779856, 2.3499113048851656, 2.356194490192345, 2.3624776754995245, 2.368760860806704, 2.3750440461138838, 2.381327231421063, 2.387610416728243, 2.3938936020354222, 2.400176787342602, 2.4064599726497815, 2.412743157956961, 2.419026343264141, 2.4253095285713204, 2.4315927138785, 2.4378758991856793, 2.4441590844928593, 2.4504422698000385, 2.456725455107218, 2.463008640414398, 2.4692918257215775, 2.4755750110287567, 2.4818581963359367, 2.4881413816431164, 2.4944245669502956, 2.5007077522574757, 2.506990937564655, 2.5132741228718345, 2.519557308179014, 2.5258404934861938, 2.532123678793373, 2.538406864100553, 2.5446900494077322, 2.550973234714912, 2.557256420022092, 2.563539605329271, 2.569822790636451, 2.5761059759436304, 2.58238916125081, 2.5886723465579893, 2.5949555318651694, 2.6012387171723486, 2.607521902479528, 2.6138050877867083, 2.6200882730938875, 2.626371458401067, 2.6326546437082468, 2.6389378290154264, 2.6452210143226056, 2.6515041996297857, 2.657787384936965, 2.6640705702441445, 2.670353755551324, 2.676636940858504, 2.6829201261656834, 2.689203311472863, 2.6954864967800427, 2.701769682087222, 2.708052867394402, 2.714336052701581, 2.720619238008761, 2.7269024233159405, 2.73318560862312, 2.7394687939302993, 2.7457519792374794, 2.752035164544659, 2.758318349851838, 2.7646015351590183, 2.7708847204661975, 2.777167905773377, 2.7834510910805568, 2.7897342763877364, 2.7960174616949156, 2.8023006470020957, 2.808583832309275, 2.8148670176164545, 2.8211502029236346, 2.827433388230814, 2.8337165735379934, 2.839999758845173, 2.8462829441523527, 2.852566129459532, 2.858849314766712, 2.865132500073891, 2.871415685381071, 2.8776988706882505, 2.88398205599543, 2.8902652413026098, 2.8965484266097894, 2.902831611916969, 2.9091147972241482, 2.9153979825313283, 2.9216811678385075, 2.927964353145687, 2.934247538452867, 2.9405307237600464, 2.9468139090672256, 2.9530970943744057, 2.9593802796815853, 2.9656634649887645, 2.9719466502959446, 2.978229835603124, 2.9845130209103035, 2.990796206217483, 2.9970793915246627, 3.003362576831842, 3.009645762139022, 3.015928947446201, 3.022212132753381, 3.028495318060561, 3.03477850336774, 3.0410616886749198, 3.0473448739820994, 3.053628059289279, 3.0599112445964582, 3.0661944299036383, 3.0724776152108175, 3.078760800517997, 3.0850439858251772, 3.0913271711323564, 3.097610356439536, 3.1038935417467157, 3.1101767270538954, 3.1164599123610746, 3.1227430976682546, 3.129026282975434, 3.1353094682826135, 3.141592653589793, 3.1478758388969728, 3.1541590242041524, 3.160442209511332, 3.1667253948185117, 3.173008580125691, 3.179291765432871, 3.18557495074005, 3.19185813604723, 3.1981413213544094, 3.204424506661589, 3.2107076919687683, 3.2169908772759483, 3.223274062583128, 3.229557247890307, 3.2358404331974873, 3.2421236185046665, 3.248406803811846, 3.2546899891190257, 3.2609731744262054, 3.2672563597333846, 3.2735395450405647, 3.279822730347744, 3.2861059156549235, 3.2923891009621036, 3.2986722862692828, 3.3049554715764624, 3.311238656883642, 3.3175218421908217, 3.323805027498001, 3.330088212805181, 3.33637139811236, 3.34265458341954, 3.3489377687267194, 3.355220954033899, 3.3615041393410787, 3.3677873246482584, 3.374070509955438, 3.380353695262617, 3.3866368805697973, 3.3929200658769765, 3.399203251184156, 3.4054864364913358, 3.4117696217985154, 3.418052807105695, 3.4243359924128747, 3.4306191777200543, 3.4369023630272335, 3.4431855483344136, 3.449468733641593, 3.4557519189487724, 3.462035104255952, 3.4683182895631317, 3.474601474870311, 3.480884660177491, 3.4871678454846706, 3.49345103079185, 3.49973421609903, 3.506017401406209, 3.5123005867133887, 3.5185837720205684, 3.524866957327748, 3.531150142634927, 3.5374333279421073, 3.5437165132492865, 3.549999698556466, 3.556282883863646, 3.5625660691708254, 3.568849254478005, 3.5751324397851847, 3.5814156250923643, 3.5876988103995435, 3.5939819957067236, 3.600265181013903, 3.6065483663210824, 3.612831551628262, 3.6191147369354417, 3.6253979222426214, 3.631681107549801, 3.6379642928569806, 3.64424747816416, 3.65053066347134, 3.656813848778519, 3.6630970340856988, 3.6693802193928784, 3.675663404700058, 3.6819465900072372, 3.6882297753144173, 3.694512960621597, 3.700796145928776, 3.7070793312359562, 3.7133625165431354, 3.719645701850315, 3.7259288871574947, 3.7322120724646743, 3.7384952577718535, 3.7447784430790336, 3.751061628386213, 3.7573448136933925, 3.7636279990005725, 3.7699111843077517, 3.7761943696149314, 3.782477554922111, 3.7887607402292907, 3.79504392553647, 3.80132711084365, 3.807610296150829, 3.8138934814580088, 3.8201766667651884, 3.826459852072368, 3.8327430373795477, 3.8390262226867273, 3.845309407993907, 3.851592593301086, 3.8578757786082662, 3.8641589639154454, 3.870442149222625, 3.8767253345298047, 3.8830085198369844, 3.889291705144164, 3.8955748904513436, 3.9018580757585233, 3.9081412610657025, 3.9144244463728826, 3.9207076316800618, 3.9269908169872414, 3.933274002294421, 3.9395571876016007, 3.94584037290878, 3.95212355821596, 3.9584067435231396, 3.964689928830319, 3.970973114137499, 3.977256299444678, 3.9835394847518577, 3.9898226700590373, 3.996105855366217, 4.002389040673396, 4.008672225980576, 4.0149554112877555, 4.0212385965949355, 4.027521781902115, 4.033804967209294, 4.040088152516474, 4.046371337823653, 4.052654523130833, 4.0589377084380125, 4.065220893745193, 4.071504079052372, 4.077787264359552, 4.084070449666731, 4.09035363497391, 4.09663682028109, 4.10292000558827, 4.10920319089545, 4.115486376202629, 4.121769561509808, 4.128052746816988, 4.134335932124168, 4.140619117431347, 4.146902302738527, 4.153185488045707, 4.159468673352886, 4.165751858660065, 4.172035043967246, 4.178318229274425, 4.184601414581604, 4.190884599888784, 4.197167785195964, 4.203450970503143, 4.209734155810323, 4.216017341117502, 4.222300526424682, 4.228583711731861, 4.234866897039041, 4.241150082346221, 4.247433267653401, 4.25371645296058, 4.259999638267759, 4.266282823574939, 4.2725660088821185, 4.278849194189298, 4.285132379496478, 4.291415564803658, 4.297698750110837, 4.303981935418016, 4.310265120725196, 4.3165483060323755, 4.322831491339556, 4.329114676646735, 4.335397861953915, 4.341681047261094, 4.347964232568273, 4.354247417875452, 4.360530603182633, 4.366813788489813, 4.373096973796992, 4.379380159104172, 4.385663344411351, 4.39194652971853, 4.39822971502571, 4.4045129003328904, 4.41079608564007, 4.417079270947249, 4.423362456254428, 4.429645641561608, 4.435928826868788, 4.442212012175967, 4.4484951974831475, 4.454778382790327, 4.461061568097506, 4.467344753404685, 4.473627938711866, 4.479911124019045, 4.486194309326224, 4.4924774946334045, 4.498760679940584, 4.505043865247763, 4.511327050554943, 4.517610235862123, 4.523893421169302, 4.5301766064764815, 4.536459791783661, 4.542742977090841, 4.549026162398021, 4.5553093477052, 4.56159253301238, 4.567875718319559, 4.5741589036267385, 4.580442088933918, 4.586725274241099, 4.593008459548278, 4.599291644855457, 4.605574830162636, 4.611858015469816, 4.6181412007769955, 4.624424386084176, 4.630707571391356, 4.636990756698535, 4.643273942005714, 4.649557127312893, 4.655840312620073, 4.6621234979272534, 4.668406683234433, 4.674689868541612, 4.680973053848792, 4.687256239155971, 4.69353942446315, 4.699822609770331, 4.7061057950775105, 4.71238898038469, 4.718672165691869, 4.724955350999049, 4.731238536306228, 4.737521721613408, 4.743804906920587, 4.7500880922277675, 4.756371277534947, 4.762654462842126, 4.768937648149306, 4.775220833456486, 4.781504018763665, 4.7877872040708445, 4.7940703893780245, 4.800353574685204, 4.806636759992383, 4.812919945299563, 4.819203130606743, 4.825486315913922, 4.8317695012211015, 4.838052686528282, 4.844335871835461, 4.850619057142641, 4.85690224244982, 4.863185427757, 4.869468613064179, 4.8757517983713585, 4.882034983678538, 4.888318168985719, 4.894601354292898, 4.900884539600077, 4.907167724907257, 4.913450910214436, 4.919734095521616, 4.926017280828796, 4.932300466135976, 4.938583651443155, 4.944866836750334, 4.951150022057513, 4.957433207364693, 4.9637163926718735, 4.969999577979053, 4.976282763286233, 4.982565948593412, 4.988849133900591, 4.99513231920777, 5.001415504514951, 5.0076986898221305, 5.01398187512931, 5.020265060436489, 5.026548245743669, 5.032831431050848, 5.039114616358028, 5.045397801665208, 5.0516809869723875, 5.057964172279567, 5.064247357586746, 5.070530542893926, 5.076813728201106, 5.083096913508285, 5.0893800988154645, 5.095663284122645, 5.101946469429824, 5.108229654737003, 5.114512840044184, 5.120796025351363, 5.127079210658542, 5.1333623959657215, 5.139645581272902, 5.145928766580081, 5.152211951887261, 5.15849513719444, 5.16477832250162, 5.171061507808799, 5.177344693115979, 5.183627878423159, 5.189911063730339, 5.196194249037518, 5.202477434344697, 5.208760619651877, 5.215043804959056, 5.221326990266236, 5.227610175573417, 5.233893360880596, 5.240176546187775, 5.246459731494954, 5.252742916802134, 5.259026102109313, 5.2653092874164935, 5.271592472723673, 5.277875658030853, 5.284158843338032, 5.290442028645211, 5.296725213952391, 5.303008399259571, 5.3092915845667505, 5.31557476987393, 5.32185795518111, 5.328141140488289, 5.334424325795468, 5.340707511102648, 5.346990696409828, 5.353273881717008, 5.359557067024187, 5.365840252331367, 5.372123437638546, 5.378406622945726, 5.384689808252905, 5.390972993560085, 5.397256178867265, 5.403539364174444, 5.409822549481623, 5.416105734788804, 5.422388920095983, 5.428672105403162, 5.4349552907103424, 5.441238476017522, 5.447521661324701, 5.453804846631881, 5.460088031939061, 5.46637121724624, 5.472654402553419, 5.478937587860599, 5.485220773167779, 5.491503958474959, 5.497787143782138, 5.504070329089318, 5.510353514396497, 5.516636699703676, 5.522919885010856, 5.529203070318037, 5.535486255625216, 5.541769440932395, 5.548052626239574, 5.554335811546754, 5.5606189968539335, 5.5669021821611135, 5.573185367468294, 5.579468552775473, 5.585751738082652, 5.592034923389831, 5.598318108697011, 5.604601294004191, 5.610884479311371, 5.61716766461855, 5.62345084992573, 5.629734035232909, 5.636017220540088, 5.642300405847269, 5.648583591154448, 5.654866776461628, 5.661149961768807, 5.667433147075987, 5.673716332383166, 5.679999517690346, 5.686282702997525, 5.6925658883047054, 5.698849073611885, 5.705132258919064, 5.711415444226244, 5.717698629533424, 5.723981814840603, 5.730265000147782, 5.7365481854549625, 5.742831370762142, 5.749114556069321, 5.755397741376501, 5.761680926683681, 5.76796411199086, 5.774247297298039, 5.7805304826052195, 5.786813667912399, 5.793096853219579, 5.799380038526758, 5.805663223833938, 5.811946409141117, 5.8182295944482965, 5.824512779755476, 5.830795965062657, 5.837079150369836, 5.843362335677015, 5.849645520984195, 5.855928706291374, 5.8622118915985535, 5.868495076905734, 5.874778262212914, 5.881061447520093, 5.887344632827272, 5.893627818134451, 5.899911003441631, 5.906194188748811, 5.912477374055991, 5.918760559363171, 5.92504374467035, 5.931326929977529, 5.937610115284708, 5.943893300591889, 5.9501764858990684, 5.956459671206248, 5.962742856513427, 5.969026041820607, 5.975309227127786, 5.981592412434966, 5.987875597742146, 5.9941587830493255, 6.000441968356505, 6.006725153663684, 6.013008338970864, 6.019291524278044, 6.025574709585223, 6.031857894892402, 6.0381410801995825, 6.044424265506762, 6.050707450813941, 6.056990636121122, 6.063273821428301, 6.06955700673548, 6.0758401920426595, 6.0821233773498395, 6.088406562657019, 6.094689747964199, 6.100972933271379, 6.107256118578558, 6.113539303885737, 6.1198224891929165, 6.126105674500097, 6.132388859807277, 6.138672045114456, 6.144955230421635, 6.151238415728815, 6.157521601035994, 6.1638047863431735, 6.1700879716503545, 6.176371156957534, 6.182654342264713, 6.188937527571892, 6.195220712879072, 6.201503898186251, 6.2077870834934314, 6.214070268800611, 6.220353454107791, 6.22663663941497, 6.232919824722149, 6.239203010029329, 6.245486195336509, 6.2517693806436885, 6.258052565950868, 6.264335751258048, 6.270618936565227, 6.276902121872406], [303, 305, 305, 304, 304, 304, 304, 304, 304, 304, 304, 304, 303, 304, 303, 303, 303, 303, 303, 303, 303, 302, 302, 303, 302, 302, 301, 302, 301, 300, 301, 300, 301, 300, 301, 302, 301, 301, 300, 300, 300, 300, 301, 300, 300, 300, 301, 300, 300, 300, 299, 300, 299, 299, 299, 299, 299, 298, 299, 299, 299, 298, 299, 298, 298, 298, 299, 298, 298, 298, 298, 297, 297, 297, 297, 297, 296, 296, 297, 296, 296, 297, 297, 297, 297, 296, 297, 296, 295, 296, 295, 295, 295, 295, 295, 295, 294, 295, 294, 294, 294, 293, 294, 294, 294, 294, 293, 293, 233, 226, 223, 221, 218, 216, 215, 213, 213, 212, 210, 209, 207, 208, 207, 206, 205, 205, 204, 204, 203, 203, 203, 202, 202, 202, 203, 203, 202, 202, 202, 202, 203, 202, 202, 202, 204, 204, 204, 205, 206, 206, 206, 207, 208, 209, 210, 211, 212, 214, 216, 218, 220, 224, 230, 232, 233, 239, 283, 283, 284, 283, 283, 282, 282, 283, 282, 283, 282, 281, 281, 282, 281, 281, 281, 281, 281, 280, 280, 281, 280, 280, 279, 280, 280, 279, 280, 279, 278, 279, 278, 279, 278, 279, 278, 277, 277, 277, 277, 276, 278, 278, 277, 277, 276, 277, 277, 277, 277, 277, 277, 278, 277, 277, 276, 275, 276, 276, 276, 275, 275, 275, 276, 274, 274, 274, 275, 275, 275, 274, 274, 273, 274, 274, 274, 274, 274, 275, 275, 274, 273, 272, 272, 274, 275, 274, 273, 275, 314, 314, 304, 300, 300, 298, 296, 298, 295, 295, 315, 315, 316, 316, 316, 316, 317, 309, 317, 317, 318, 227, 219, 215, 210, 208, 207, 203, 200, 199, 198, 197, 197, 196, 197, 196, 196, 196, 195, 195, 194, 194, 193, 192, 192, 191, 190, 190, 189, 190, 189, 188, 188, 188, 188, 188, 187, 188, 188, 188, 188, 188, 188, 189, 188, 189, 189, 190, 191, 191, 192, 192, 193, 193, 193, 195, 196, 196, 198, 199, 201, 202, 204, 204, 209, 213, 216, 222, 250, 251, 252, 253, 254, 255, 256, 257, 258, 260, 261, 256, 254, 252, 252, 253, 255, 256, 257, 259, 262, 262, 267, 265, 265, 265, 265, 267, 267, 268, 268, 267, 267, 267, 267, 267, 267, 267, 267, 267, 267, 267, 267, 267, 267, 268, 268, 267, 267, 267, 267, 267, 267, 267, 267, 267, 267, 267, 266, 267, 266, 266, 266, 266, 267, 267, 267, 266, 266, 266, 266, 266, 266, 266, 266, 266, 266, 266, 266, 266, 266, 266, 266, 266, 265, 265, 266, 266, 265, 266, 265, 265, 266, 265, 265, 266, 265, 265, 265, 265, 266, 265, 266, 265, 265, 265, 265, 265, 265, 265, 265, 265, 265, 265, 266, 265, 265, 265, 265, 266, 265, 265, 226, 222, 218, 216, 211, 210, 210, 208, 208, 207, 206, 205, 204, 203, 203, 202, 202, 202, 201, 200, 200, 200, 200, 200, 199, 199, 199, 199, 199, 199, 199, 199, 199, 199, 199, 199, 199, 199, 200, 200, 200, 200, 200, 201, 201, 201, 202, 203, 203, 204, 206, 206, 207, 208, 208, 210, 213, 213, 214, 216, 220, 225, 268, 267, 267, 268, 267, 267, 268, 267, 267, 268, 268, 267, 268, 268, 268, 268, 268, 268, 268, 268, 269, 268, 269, 268, 269, 268, 269, 268, 269, 227, 220, 220, 216, 213, 212, 211, 208, 208, 207, 206, 205, 204, 203, 203, 203, 202, 201, 201, 201, 200, 200, 199, 199, 199, 199, 199, 198, 198, 199, 198, 199, 199, 199, 199, 199, 199, 199, 200, 201, 200, 201, 201, 202, 203, 202, 203, 204, 205, 206, 207, 207, 208, 209, 212, 213, 214, 215, 217, 220, 223, 224, 236, 274, 274, 274, 274, 275, 274, 275, 275, 275, 275, 275, 276, 275, 276, 276, 276, 276, 276, 277, 277, 277, 277, 276, 278, 277, 277, 277, 277, 277, 277, 277, 278, 278, 278, 278, 278, 278, 278, 279, 279, 279, 279, 279, 279, 279, 280, 279, 279, 280, 281, 280, 280, 280, 281, 281, 281, 281, 281, 282, 282, 282, 281, 282, 282, 282, 283, 283, 283, 284, 283, 283, 284, 284, 283, 284, 284, 285, 285, 285, 285, 284, 285, 285, 286, 285, 286, 286, 286, 286, 287, 286, 287, 287, 287, 287, 287, 288, 288, 287, 288, 289, 288, 288, 289, 289, 289, 289, 290, 289, 290, 290, 290, 290, 290, 290, 291, 291, 290, 291, 291, 291, 291, 292, 292, 292, 292, 293, 292, 293, 293, 293, 294, 294, 294, 294, 294, 294, 294, 294, 294, 294, 294, 294, 295, 296, 296, 296, 295, 295, 296, 296, 296, 296, 297, 297, 297, 297, 297, 297, 296, 297, 297, 297, 298, 297, 298, 298, 298, 299, 298, 299, 299, 299, 299, 254, 246, 244, 239, 237, 234, 232, 230, 229, 228, 227, 226, 225, 224, 223, 223, 222, 221, 221, 220, 221, 221, 220, 220, 219, 220, 219, 220, 219, 220, 221, 220, 221, 222, 221, 222, 223, 224, 224, 225, 226, 228, 229, 230, 232, 234, 236, 237, 240, 242, 250, 306, 306, 305, 305, 305, 306, 306, 306, 306, 306, 305, 307, 307, 307, 307, 306, 307, 307, 307, 306, 307, 307, 307, 307, 307, 307, 306, 307, 307, 306, 307, 307, 307, 307, 308, 307, 307, 308, 308, 308, 307, 308, 307, 308, 307, 307, 308, 307, 308, 307, 308, 308, 308, 308, 307, 308, 308, 308, 308, 308, 308, 309, 308, 308, 308, 308, 308, 308, 308, 308, 308, 308, 308, 308, 307, 308, 309, 308, 309, 308, 308, 308, 308, 308, 307, 308, 308, 308, 307, 307, 308, 308, 308, 307, 308, 308, 308, 308, 308, 307, 308, 308, 307, 308, 307, 307, 250, 246, 243, 239, 237, 235, 234, 232, 231, 230, 229, 228, 228, 226, 226, 226, 224, 224, 224, 223, 223, 223, 224, 223, 223, 223, 224, 224, 223, 223, 224, 224, 225, 226, 225, 226, 227, 227, 229, 229, 231, 233, 233, 236, 237, 240, 242, 244, 249]]
'''
askedImage = cv2.imread("KUV.jpg",0)

centerX = 405
centerY=307



#Performs sobel operator before masking
img = cv2.imread("KUV.jpg",0)
sobelImage = simonsMagic.main(img) #Sobel + gradient masking
sobelImage = np.array(sobelImage.astype(np.uint8))
'''

#For skipping sobel uncomment>
sobelImage = cv2.imread("KUV.jpg",0)
'''
#Testing Simons mirror stuff
channel=gf.getSizeLimited(sobelImage,2**16)

mirrorChannel=gf.getNormalised(fibreAnalyser.getMirrorSymmetryChannel(channel))
mirrorCenter=[float(i) for i in gf.getArrayMaxIndex(mirrorChannel)]
scale = sobelImage.shape[0]/mirrorChannel.shape[0]
#print("mirrorCenter=",str(mirrorCenter[0]*scale), str(mirrorCenter[1]*scale))
print(mirrorCenter[-1::-1])
center = [i*scale for i in mirrorCenter]
print(center)

rotationMatrix=cv2.getRotationMatrix2D(center[-1::-1], 30, 1.)
rotatedChannel=cv2.warpAffine( sobelImage, rotationMatrix, sobelImage.shape[-1::-1] )
#input(rotatedChannel)

#PIL.Image.fromarray(mirrorChannel*255).show()
PIL.Image.fromarray(gf.getNormalised(rotatedChannel)*255).show()

#mirrorCenter[0] = mirrorCenter[0]*scale
#mirrorCenter[1] = mirrorCenter[1]*scale
#print(mirrorCenter[0], mirrorCenter[1])
#PIL.Image.fromarray(mirrorChannel).show()

'''
maskedImage = (CallableMasker.main(sobelImage))
#PIL.Image.fromarray(maskedImage).show()


centerX, centerY = manualCenterFinder.main(maskedImage)
#print(centerX, centerY)


'''
#True means pass masked image, false will circle a raw photo
circleData = callableCircleFinder.main(maskedImage, True)
t1=dt.now()-t1
print(t1)
t1=dt.now()


#circleData=np.array([[[1971, 1945,  103],[1521 ,1747 , 103],  [1719, 1891  ,104],  [2501 ,1039,  103],  [2429, 1747 ,  82],  [2107,  771,  109],  [1459, 1057 , 104],  [1399, 1539 ,  75],  [1377, 1287 , 105],  [2553, 1533  , 95],  [1631  ,877 , 104],  [2337  ,863,   88],  [2585, 1275 , 105],  [2217, 1897 , 101],  [1865 , 767 ,  84]]])

centerX, centerY = fromScratch.capCenterFinder(circleData)
t1=dt.now()-t1
print(t1)
t1=dt.now()

angles, gaps = fromScratch.capSymmetry(circleData, centerX, centerY)
t1=dt.now()-t1
print(t1)
t1=dt.now()

#plotImg = cv2.imread("untapered.png")
#fromScratch.plotPolarLines(centerX, centerY, angles, maskedImage)
#t1=dt.now()-t1
#print(t1)
#t1=dt.now()

'''
radPlot, _ = fromScratch.coreRadiusPlotter(centerX, centerY, maskedImage)

noCapRadPlot = fromScratch.roughCapExcluder(radPlot)
sinParams = plotFitting.fitSinFunc(noCapRadPlot)
centerX, centerY = fromScratch.reCenter(centerX, centerY, sinParams)
radPlot, coreBoundCoords = fromScratch.coreRadiusPlotter(centerX, centerY, maskedImage, 1000)

fig = plt.figure()
fig.patch.set_facecolor('white')
plt.plot(radPlot[0], radPlot[1], 'k')
plt.xlabel("Angle (radians)")
plt.ylabel("Radius (pixels)")

plt.savefig('radplot.png', dpi=1000)
plt.show()
#plt.close()

smoothedRads, grads = fromScratch.smoothRadsAndFindGrads(radPlot)

fig = plt.figure()
plt.plot(grads[0], grads[1], 'k')

fig.patch.set_facecolor('white')
plt.xlabel("Angle (radians)")
plt.ylabel("Gradient of radial plot \n(pixels/radian)")

fig.savefig('gradplot.png', dpi=1000)
plt.show()

'''
#radPlotFile
capEdges = CallableGUICapFinder2.main(smoothedRads, grads, maskedImage, centerX, centerY)
#print(capEdges)


capEdges = [[0.26389378290154264, 1],[0.6660176425610361, 0], [1.3131857292005336, 1], [1.7467255153959251, 0], [2.4190263432641403, 1], [2.7520351645446586, 0], [3.436902363027233, 1], [3.782477554922111, 0], [4.467344753404686, 1], [4.819203130606742, 0], [5.497787143782138, 1], [5.893627818134452, 0]]
#radPlot = [[0.0, 0.006283185307179587, 0.012566370614359173, 0.01884955592153876, 0.025132741228718346, 0.031415926535897934, 0.03769911184307752, 0.0439822971502571, 0.05026548245743669, 0.05654866776461628, 0.06283185307179587, 0.06911503837897544, 0.07539822368615504, 0.08168140899333463, 0.0879645943005142, 0.09424777960769379, 0.10053096491487339, 0.10681415022205297, 0.11309733552923255, 0.11938052083641214, 0.12566370614359174, 0.13194689145077132, 0.13823007675795088, 0.1445132620651305, 0.15079644737231007, 0.15707963267948966, 0.16336281798666927, 0.16964600329384882, 0.1759291886010284, 0.18221237390820802, 0.18849555921538758, 0.19477874452256716, 0.20106192982974677, 0.20734511513692636, 0.21362830044410594, 0.21991148575128552, 0.2261946710584651, 0.2324778563656447, 0.23876104167282428, 0.24504422698000386, 0.25132741228718347, 0.257610597594363, 0.26389378290154264, 0.2701769682087222, 0.27646015351590175, 0.2827433388230814, 0.289026524130261, 0.29530970943744056, 0.30159289474462014, 0.3078760800517997, 0.3141592653589793, 0.3204424506661589, 0.32672563597333854, 0.33300882128051806, 0.33929200658769765, 0.3455751918948773, 0.3518583772020568, 0.3581415625092364, 0.36442474781641604, 0.37070793312359557, 0.37699111843077515, 0.3832743037379548, 0.3895574890451343, 0.39584067435231396, 0.40212385965949354, 0.40840704496667307, 0.4146902302738527, 0.4209734155810323, 0.4272566008882119, 0.43353978619539146, 0.43982297150257105, 0.44610615680975063, 0.4523893421169302, 0.4586725274241098, 0.4649557127312894, 0.47123889803846897, 0.47752208334564855, 0.48380526865282814, 0.4900884539600077, 0.49637163926718736, 0.5026548245743669, 0.5089380098815465, 0.515221195188726, 0.5215043804959058, 0.5277875658030853, 0.5340707511102648, 0.5403539364174444, 0.546637121724624, 0.5529203070318035, 0.5592034923389833, 0.5654866776461628, 0.5717698629533423, 0.578053048260522, 0.5843362335677015, 0.5906194188748811, 0.5969026041820608, 0.6031857894892403, 0.6094689747964198, 0.6157521601035995, 0.6220353454107791, 0.6283185307179586, 0.6346017160251383, 0.6408849013323178, 0.6471680866394973, 0.6534512719466771, 0.6597344572538566, 0.6660176425610361, 0.6723008278682158, 0.6785840131753953, 0.6848671984825748, 0.6911503837897546, 0.6974335690969341, 0.7037167544041136, 0.7099999397112933, 0.7162831250184728, 0.7225663103256524, 0.7288494956328321, 0.7351326809400116, 0.7414158662471911, 0.7476990515543708, 0.7539822368615503, 0.7602654221687299, 0.7665486074759096, 0.7728317927830891, 0.7791149780902686, 0.7853981633974483, 0.7916813487046279, 0.7979645340118074, 0.8042477193189871, 0.8105309046261666, 0.8168140899333461, 0.8230972752405259, 0.8293804605477054, 0.835663645854885, 0.8419468311620646, 0.8482300164692441, 0.8545132017764238, 0.8607963870836034, 0.8670795723907829, 0.8733627576979625, 0.8796459430051421, 0.8859291283123216, 0.8922123136195013, 0.8984954989266809, 0.9047786842338604, 0.91106186954104, 0.9173450548482196, 0.9236282401553992, 0.9299114254625788, 0.9361946107697584, 0.9424777960769379, 0.9487609813841175, 0.9550441666912971, 0.9613273519984767, 0.9676105373056563, 0.9738937226128359, 0.9801769079200154, 0.986460093227195, 0.9927432785343747, 0.9990264638415542, 1.0053096491487339, 1.0115928344559133, 1.017876019763093, 1.0241592050702726, 1.030442390377452, 1.0367255756846316, 1.0430087609918115, 1.049291946298991, 1.0555751316061706, 1.0618583169133502, 1.0681415022205296, 1.0744246875277093, 1.080707872834889, 1.0869910581420683, 1.093274243449248, 1.0995574287564276, 1.105840614063607, 1.1121237993707869, 1.1184069846779665, 1.124690169985146, 1.1309733552923256, 1.1372565405995052, 1.1435397259066846, 1.1498229112138643, 1.156106096521044, 1.1623892818282233, 1.168672467135403, 1.1749556524425828, 1.1812388377497622, 1.1875220230569419, 1.1938052083641215, 1.200088393671301, 1.2063715789784806, 1.2126547642856602, 1.2189379495928396, 1.2252211349000193, 1.231504320207199, 1.2377875055143783, 1.2440706908215582, 1.2503538761287378, 1.2566370614359172, 1.2629202467430969, 1.2692034320502765, 1.275486617357456, 1.2817698026646356, 1.2880529879718152, 1.2943361732789946, 1.3006193585861743, 1.3069025438933541, 1.3131857292005336, 1.3194689145077132, 1.3257520998148928, 1.3320352851220723, 1.338318470429252, 1.3446016557364315, 1.350884841043611, 1.3571680263507906, 1.3634512116579702, 1.3697343969651496, 1.3760175822723295, 1.3823007675795091, 1.3885839528866886, 1.3948671381938682, 1.4011503235010478, 1.4074335088082273, 1.413716694115407, 1.4199998794225865, 1.426283064729766, 1.4325662500369456, 1.4388494353441252, 1.4451326206513049, 1.4514158059584845, 1.4576989912656642, 1.4639821765728436, 1.4702653618800232, 1.4765485471872029, 1.4828317324943823, 1.489114917801562, 1.4953981031087415, 1.501681288415921, 1.5079644737231006, 1.5142476590302805, 1.5205308443374599, 1.5268140296446395, 1.5330972149518192, 1.5393804002589986, 1.5456635855661782, 1.5519467708733579, 1.5582299561805373, 1.564513141487717, 1.5707963267948966, 1.5770795121020762, 1.5833626974092558, 1.5896458827164355, 1.595929068023615, 1.6022122533307945, 1.6084954386379742, 1.6147786239451536, 1.6210618092523332, 1.6273449945595129, 1.6336281798666923, 1.639911365173872, 1.6461945504810518, 1.6524777357882312, 1.6587609210954108, 1.6650441064025905, 1.67132729170977, 1.6776104770169495, 1.6838936623241292, 1.6901768476313086, 1.6964600329384882, 1.7027432182456679, 1.7090264035528475, 1.7153095888600272, 1.7215927741672068, 1.7278759594743862, 1.7341591447815659, 1.7404423300887455, 1.746725515395925, 1.7530087007031045, 1.7592918860102842, 1.7655750713174636, 1.7718582566246432, 1.778141441931823, 1.7844246272390025, 1.7907078125461822, 1.7969909978533618, 1.8032741831605412, 1.8095573684677209, 1.8158405537749005, 1.82212373908208, 1.8284069243892596, 1.8346901096964392, 1.8409732950036186, 1.8472564803107985, 1.8535396656179781, 1.8598228509251575, 1.8661060362323372, 1.8723892215395168, 1.8786724068466962, 1.8849555921538759, 1.8912387774610555, 1.897521962768235, 1.9038051480754146, 1.9100883333825942, 1.9163715186897738, 1.9226547039969535, 1.9289378893041331, 1.9352210746113125, 1.9415042599184922, 1.9477874452256718, 1.9540706305328512, 1.9603538158400309, 1.9666370011472105, 1.97292018645439, 1.9792033717615698, 1.9854865570687494, 1.9917697423759289, 1.9980529276831085, 2.004336112990288, 2.0106192982974678, 2.016902483604647, 2.0231856689118266, 2.0294688542190062, 2.035752039526186, 2.0420352248333655, 2.048318410140545, 2.054601595447725, 2.060884780754904, 2.067167966062084, 2.0734511513692633, 2.079734336676443, 2.086017521983623, 2.092300707290802, 2.098583892597982, 2.1048670779051615, 2.111150263212341, 2.1174334485195203, 2.1237166338267004, 2.1299998191338796, 2.1362830044410592, 2.142566189748239, 2.1488493750554185, 2.155132560362598, 2.161415745669778, 2.1676989309769574, 2.1739821162841366, 2.1802653015913167, 2.186548486898496, 2.1928316722056755, 2.199114857512855, 2.205398042820035, 2.211681228127214, 2.217964413434394, 2.2242475987415737, 2.230530784048753, 2.236813969355933, 2.243097154663112, 2.249380339970292, 2.2556635252774715, 2.261946710584651, 2.2682298958918303, 2.2745130811990104, 2.28079626650619, 2.2870794518133692, 2.2933626371205493, 2.2996458224277285, 2.305929007734908, 2.312212193042088, 2.3184953783492674, 2.3247785636564466, 2.3310617489636267, 2.337344934270806, 2.3436281195779856, 2.3499113048851656, 2.356194490192345, 2.3624776754995245, 2.368760860806704, 2.3750440461138838, 2.381327231421063, 2.387610416728243, 2.3938936020354222, 2.400176787342602, 2.4064599726497815, 2.412743157956961, 2.419026343264141, 2.4253095285713204, 2.4315927138785, 2.4378758991856793, 2.4441590844928593, 2.4504422698000385, 2.456725455107218, 2.463008640414398, 2.4692918257215775, 2.4755750110287567, 2.4818581963359367, 2.4881413816431164, 2.4944245669502956, 2.5007077522574757, 2.506990937564655, 2.5132741228718345, 2.519557308179014, 2.5258404934861938, 2.532123678793373, 2.538406864100553, 2.5446900494077322, 2.550973234714912, 2.557256420022092, 2.563539605329271, 2.569822790636451, 2.5761059759436304, 2.58238916125081, 2.5886723465579893, 2.5949555318651694, 2.6012387171723486, 2.607521902479528, 2.6138050877867083, 2.6200882730938875, 2.626371458401067, 2.6326546437082468, 2.6389378290154264, 2.6452210143226056, 2.6515041996297857, 2.657787384936965, 2.6640705702441445, 2.670353755551324, 2.676636940858504, 2.6829201261656834, 2.689203311472863, 2.6954864967800427, 2.701769682087222, 2.708052867394402, 2.714336052701581, 2.720619238008761, 2.7269024233159405, 2.73318560862312, 2.7394687939302993, 2.7457519792374794, 2.752035164544659, 2.758318349851838, 2.7646015351590183, 2.7708847204661975, 2.777167905773377, 2.7834510910805568, 2.7897342763877364, 2.7960174616949156, 2.8023006470020957, 2.808583832309275, 2.8148670176164545, 2.8211502029236346, 2.827433388230814, 2.8337165735379934, 2.839999758845173, 2.8462829441523527, 2.852566129459532, 2.858849314766712, 2.865132500073891, 2.871415685381071, 2.8776988706882505, 2.88398205599543, 2.8902652413026098, 2.8965484266097894, 2.902831611916969, 2.9091147972241482, 2.9153979825313283, 2.9216811678385075, 2.927964353145687, 2.934247538452867, 2.9405307237600464, 2.9468139090672256, 2.9530970943744057, 2.9593802796815853, 2.9656634649887645, 2.9719466502959446, 2.978229835603124, 2.9845130209103035, 2.990796206217483, 2.9970793915246627, 3.003362576831842, 3.009645762139022, 3.015928947446201, 3.022212132753381, 3.028495318060561, 3.03477850336774, 3.0410616886749198, 3.0473448739820994, 3.053628059289279, 3.0599112445964582, 3.0661944299036383, 3.0724776152108175, 3.078760800517997, 3.0850439858251772, 3.0913271711323564, 3.097610356439536, 3.1038935417467157, 3.1101767270538954, 3.1164599123610746, 3.1227430976682546, 3.129026282975434, 3.1353094682826135, 3.141592653589793, 3.1478758388969728, 3.1541590242041524, 3.160442209511332, 3.1667253948185117, 3.173008580125691, 3.179291765432871, 3.18557495074005, 3.19185813604723, 3.1981413213544094, 3.204424506661589, 3.2107076919687683, 3.2169908772759483, 3.223274062583128, 3.229557247890307, 3.2358404331974873, 3.2421236185046665, 3.248406803811846, 3.2546899891190257, 3.2609731744262054, 3.2672563597333846, 3.2735395450405647, 3.279822730347744, 3.2861059156549235, 3.2923891009621036, 3.2986722862692828, 3.3049554715764624, 3.311238656883642, 3.3175218421908217, 3.323805027498001, 3.330088212805181, 3.33637139811236, 3.34265458341954, 3.3489377687267194, 3.355220954033899, 3.3615041393410787, 3.3677873246482584, 3.374070509955438, 3.380353695262617, 3.3866368805697973, 3.3929200658769765, 3.399203251184156, 3.4054864364913358, 3.4117696217985154, 3.418052807105695, 3.4243359924128747, 3.4306191777200543, 3.4369023630272335, 3.4431855483344136, 3.449468733641593, 3.4557519189487724, 3.462035104255952, 3.4683182895631317, 3.474601474870311, 3.480884660177491, 3.4871678454846706, 3.49345103079185, 3.49973421609903, 3.506017401406209, 3.5123005867133887, 3.5185837720205684, 3.524866957327748, 3.531150142634927, 3.5374333279421073, 3.5437165132492865, 3.549999698556466, 3.556282883863646, 3.5625660691708254, 3.568849254478005, 3.5751324397851847, 3.5814156250923643, 3.5876988103995435, 3.5939819957067236, 3.600265181013903, 3.6065483663210824, 3.612831551628262, 3.6191147369354417, 3.6253979222426214, 3.631681107549801, 3.6379642928569806, 3.64424747816416, 3.65053066347134, 3.656813848778519, 3.6630970340856988, 3.6693802193928784, 3.675663404700058, 3.6819465900072372, 3.6882297753144173, 3.694512960621597, 3.700796145928776, 3.7070793312359562, 3.7133625165431354, 3.719645701850315, 3.7259288871574947, 3.7322120724646743, 3.7384952577718535, 3.7447784430790336, 3.751061628386213, 3.7573448136933925, 3.7636279990005725, 3.7699111843077517, 3.7761943696149314, 3.782477554922111, 3.7887607402292907, 3.79504392553647, 3.80132711084365, 3.807610296150829, 3.8138934814580088, 3.8201766667651884, 3.826459852072368, 3.8327430373795477, 3.8390262226867273, 3.845309407993907, 3.851592593301086, 3.8578757786082662, 3.8641589639154454, 3.870442149222625, 3.8767253345298047, 3.8830085198369844, 3.889291705144164, 3.8955748904513436, 3.9018580757585233, 3.9081412610657025, 3.9144244463728826, 3.9207076316800618, 3.9269908169872414, 3.933274002294421, 3.9395571876016007, 3.94584037290878, 3.95212355821596, 3.9584067435231396, 3.964689928830319, 3.970973114137499, 3.977256299444678, 3.9835394847518577, 3.9898226700590373, 3.996105855366217, 4.002389040673396, 4.008672225980576, 4.0149554112877555, 4.0212385965949355, 4.027521781902115, 4.033804967209294, 4.040088152516474, 4.046371337823653, 4.052654523130833, 4.0589377084380125, 4.065220893745193, 4.071504079052372, 4.077787264359552, 4.084070449666731, 4.09035363497391, 4.09663682028109, 4.10292000558827, 4.10920319089545, 4.115486376202629, 4.121769561509808, 4.128052746816988, 4.134335932124168, 4.140619117431347, 4.146902302738527, 4.153185488045707, 4.159468673352886, 4.165751858660065, 4.172035043967246, 4.178318229274425, 4.184601414581604, 4.190884599888784, 4.197167785195964, 4.203450970503143, 4.209734155810323, 4.216017341117502, 4.222300526424682, 4.228583711731861, 4.234866897039041, 4.241150082346221, 4.247433267653401, 4.25371645296058, 4.259999638267759, 4.266282823574939, 4.2725660088821185, 4.278849194189298, 4.285132379496478, 4.291415564803658, 4.297698750110837, 4.303981935418016, 4.310265120725196, 4.3165483060323755, 4.322831491339556, 4.329114676646735, 4.335397861953915, 4.341681047261094, 4.347964232568273, 4.354247417875452, 4.360530603182633, 4.366813788489813, 4.373096973796992, 4.379380159104172, 4.385663344411351, 4.39194652971853, 4.39822971502571, 4.4045129003328904, 4.41079608564007, 4.417079270947249, 4.423362456254428, 4.429645641561608, 4.435928826868788, 4.442212012175967, 4.4484951974831475, 4.454778382790327, 4.461061568097506, 4.467344753404685, 4.473627938711866, 4.479911124019045, 4.486194309326224, 4.4924774946334045, 4.498760679940584, 4.505043865247763, 4.511327050554943, 4.517610235862123, 4.523893421169302, 4.5301766064764815, 4.536459791783661, 4.542742977090841, 4.549026162398021, 4.5553093477052, 4.56159253301238, 4.567875718319559, 4.5741589036267385, 4.580442088933918, 4.586725274241099, 4.593008459548278, 4.599291644855457, 4.605574830162636, 4.611858015469816, 4.6181412007769955, 4.624424386084176, 4.630707571391356, 4.636990756698535, 4.643273942005714, 4.649557127312893, 4.655840312620073, 4.6621234979272534, 4.668406683234433, 4.674689868541612, 4.680973053848792, 4.687256239155971, 4.69353942446315, 4.699822609770331, 4.7061057950775105, 4.71238898038469, 4.718672165691869, 4.724955350999049, 4.731238536306228, 4.737521721613408, 4.743804906920587, 4.7500880922277675, 4.756371277534947, 4.762654462842126, 4.768937648149306, 4.775220833456486, 4.781504018763665, 4.7877872040708445, 4.7940703893780245, 4.800353574685204, 4.806636759992383, 4.812919945299563, 4.819203130606743, 4.825486315913922, 4.8317695012211015, 4.838052686528282, 4.844335871835461, 4.850619057142641, 4.85690224244982, 4.863185427757, 4.869468613064179, 4.8757517983713585, 4.882034983678538, 4.888318168985719, 4.894601354292898, 4.900884539600077, 4.907167724907257, 4.913450910214436, 4.919734095521616, 4.926017280828796, 4.932300466135976, 4.938583651443155, 4.944866836750334, 4.951150022057513, 4.957433207364693, 4.9637163926718735, 4.969999577979053, 4.976282763286233, 4.982565948593412, 4.988849133900591, 4.99513231920777, 5.001415504514951, 5.0076986898221305, 5.01398187512931, 5.020265060436489, 5.026548245743669, 5.032831431050848, 5.039114616358028, 5.045397801665208, 5.0516809869723875, 5.057964172279567, 5.064247357586746, 5.070530542893926, 5.076813728201106, 5.083096913508285, 5.0893800988154645, 5.095663284122645, 5.101946469429824, 5.108229654737003, 5.114512840044184, 5.120796025351363, 5.127079210658542, 5.1333623959657215, 5.139645581272902, 5.145928766580081, 5.152211951887261, 5.15849513719444, 5.16477832250162, 5.171061507808799, 5.177344693115979, 5.183627878423159, 5.189911063730339, 5.196194249037518, 5.202477434344697, 5.208760619651877, 5.215043804959056, 5.221326990266236, 5.227610175573417, 5.233893360880596, 5.240176546187775, 5.246459731494954, 5.252742916802134, 5.259026102109313, 5.2653092874164935, 5.271592472723673, 5.277875658030853, 5.284158843338032, 5.290442028645211, 5.296725213952391, 5.303008399259571, 5.3092915845667505, 5.31557476987393, 5.32185795518111, 5.328141140488289, 5.334424325795468, 5.340707511102648, 5.346990696409828, 5.353273881717008, 5.359557067024187, 5.365840252331367, 5.372123437638546, 5.378406622945726, 5.384689808252905, 5.390972993560085, 5.397256178867265, 5.403539364174444, 5.409822549481623, 5.416105734788804, 5.422388920095983, 5.428672105403162, 5.4349552907103424, 5.441238476017522, 5.447521661324701, 5.453804846631881, 5.460088031939061, 5.46637121724624, 5.472654402553419, 5.478937587860599, 5.485220773167779, 5.491503958474959, 5.497787143782138, 5.504070329089318, 5.510353514396497, 5.516636699703676, 5.522919885010856, 5.529203070318037, 5.535486255625216, 5.541769440932395, 5.548052626239574, 5.554335811546754, 5.5606189968539335, 5.5669021821611135, 5.573185367468294, 5.579468552775473, 5.585751738082652, 5.592034923389831, 5.598318108697011, 5.604601294004191, 5.610884479311371, 5.61716766461855, 5.62345084992573, 5.629734035232909, 5.636017220540088, 5.642300405847269, 5.648583591154448, 5.654866776461628, 5.661149961768807, 5.667433147075987, 5.673716332383166, 5.679999517690346, 5.686282702997525, 5.6925658883047054, 5.698849073611885, 5.705132258919064, 5.711415444226244, 5.717698629533424, 5.723981814840603, 5.730265000147782, 5.7365481854549625, 5.742831370762142, 5.749114556069321, 5.755397741376501, 5.761680926683681, 5.76796411199086, 5.774247297298039, 5.7805304826052195, 5.786813667912399, 5.793096853219579, 5.799380038526758, 5.805663223833938, 5.811946409141117, 5.8182295944482965, 5.824512779755476, 5.830795965062657, 5.837079150369836, 5.843362335677015, 5.849645520984195, 5.855928706291374, 5.8622118915985535, 5.868495076905734, 5.874778262212914, 5.881061447520093, 5.887344632827272, 5.893627818134451, 5.899911003441631, 5.906194188748811, 5.912477374055991, 5.918760559363171, 5.92504374467035, 5.931326929977529, 5.937610115284708, 5.943893300591889, 5.9501764858990684, 5.956459671206248, 5.962742856513427, 5.969026041820607, 5.975309227127786, 5.981592412434966, 5.987875597742146, 5.9941587830493255, 6.000441968356505, 6.006725153663684, 6.013008338970864, 6.019291524278044, 6.025574709585223, 6.031857894892402, 6.0381410801995825, 6.044424265506762, 6.050707450813941, 6.056990636121122, 6.063273821428301, 6.06955700673548, 6.0758401920426595, 6.0821233773498395, 6.088406562657019, 6.094689747964199, 6.100972933271379, 6.107256118578558, 6.113539303885737, 6.1198224891929165, 6.126105674500097, 6.132388859807277, 6.138672045114456, 6.144955230421635, 6.151238415728815, 6.157521601035994, 6.1638047863431735, 6.1700879716503545, 6.176371156957534, 6.182654342264713, 6.188937527571892, 6.195220712879072, 6.201503898186251, 6.2077870834934314, 6.214070268800611, 6.220353454107791, 6.22663663941497, 6.232919824722149, 6.239203010029329, 6.245486195336509, 6.2517693806436885, 6.258052565950868, 6.264335751258048, 6.270618936565227, 6.276902121872406, 6.283185307179586, 6.289468492486766, 6.2957516777939455, 6.302034863101125, 6.308318048408305, 6.314601233715484, 6.320884419022664, 6.327167604329843, 6.333450789637023, 6.3397339749442025], [143, 144, 144, 145, 145, 145, 145, 146, 146, 145, 146, 146, 146, 146, 147, 147, 147, 148, 149, 150, 151, 151, 152, 152, 153, 153, 154, 155, 155, 158, 158, 159, 160, 160, 161, 165, 167, 168, 170, 172, 173, 176, 184, 188, 194, 266, 268, 268, 269, 269, 269, 269, 268, 268, 268, 267, 268, 267, 269, 269, 269, 269, 270, 269, 268, 268, 267, 269, 270, 269, 269, 269, 267, 268, 269, 267, 269, 269, 269, 269, 270, 269, 268, 268, 269, 269, 269, 269, 268, 269, 268, 269, 269, 268, 270, 268, 267, 269, 269, 268, 268, 267, 268, 269, 269, 266, 270, 270, 267, 202, 190, 187, 181, 179, 177, 172, 171, 170, 167, 166, 164, 163, 163, 162, 159, 158, 159, 158, 157, 155, 155, 154, 153, 154, 153, 152, 151, 152, 151, 150, 149, 150, 149, 149, 149, 150, 149, 147, 147, 148, 147, 147, 146, 145, 146, 147, 146, 145, 146, 147, 147, 147, 146, 145, 145, 146, 146, 146, 146, 147, 148, 147, 147, 148, 148, 149, 148, 148, 148, 148, 149, 150, 151, 151, 151, 153, 153, 154, 154, 155, 155, 156, 159, 158, 159, 159, 161, 161, 162, 163, 166, 166, 167, 170, 170, 174, 174, 178, 184, 186, 190, 267, 268, 268, 267, 267, 267, 267, 267, 268, 267, 268, 268, 267, 267, 267, 268, 267, 268, 268, 268, 267, 267, 266, 268, 268, 268, 267, 267, 267, 267, 267, 266, 267, 267, 267, 267, 267, 268, 267, 266, 267, 265, 266, 267, 267, 267, 266, 266, 266, 267, 268, 265, 266, 267, 266, 266, 266, 266, 265, 266, 266, 266, 265, 265, 266, 266, 265, 266, 265, 265, 265, 182, 174, 171, 170, 166, 164, 162, 162, 160, 158, 157, 155, 154, 152, 152, 151, 150, 149, 149, 148, 147, 145, 145, 144, 144, 144, 143, 142, 142, 142, 141, 140, 140, 140, 139, 139, 139, 138, 139, 138, 138, 139, 138, 137, 138, 137, 137, 137, 137, 138, 137, 138, 138, 137, 138, 137, 137, 137, 138, 138, 138, 138, 139, 138, 139, 139, 139, 139, 140, 140, 140, 141, 141, 141, 141, 141, 143, 142, 143, 144, 145, 145, 146, 147, 147, 147, 148, 150, 151, 151, 151, 152, 153, 156, 157, 158, 159, 161, 164, 165, 167, 168, 176, 178, 186, 260, 260, 260, 260, 260, 260, 260, 260, 260, 261, 260, 260, 260, 260, 260, 259, 259, 259, 259, 259, 259, 259, 260, 259, 260, 259, 259, 258, 259, 258, 259, 259, 259, 258, 259, 258, 259, 258, 259, 258, 258, 258, 258, 258, 258, 258, 258, 257, 258, 258, 257, 258, 257, 257, 258, 177, 169, 166, 165, 162, 159, 156, 155, 153, 152, 150, 150, 148, 147, 146, 146, 147, 142, 142, 142, 140, 140, 139, 139, 139, 137, 137, 137, 136, 136, 136, 135, 134, 134, 134, 134, 134, 134, 133, 132, 132, 132, 132, 132, 132, 132, 132, 132, 132, 131, 131, 131, 131, 131, 131, 131, 131, 131, 131, 131, 132, 132, 132, 132, 132, 132, 133, 133, 133, 133, 133, 133, 134, 134, 134, 134, 135, 135, 136, 137, 137, 138, 138, 138, 139, 139, 141, 142, 143, 143, 143, 145, 145, 146, 147, 148, 151, 151, 153, 156, 156, 157, 158, 162, 164, 169, 172, 254, 254, 255, 255, 254, 254, 254, 254, 255, 254, 255, 254, 255, 254, 255, 255, 255, 255, 255, 255, 254, 255, 254, 255, 255, 254, 255, 255, 255, 254, 255, 255, 255, 255, 254, 254, 256, 256, 255, 255, 254, 254, 255, 255, 254, 255, 255, 255, 255, 254, 255, 255, 255, 255, 255, 255, 254, 255, 177, 169, 166, 163, 160, 159, 156, 154, 153, 150, 149, 148, 147, 147, 147, 146, 143, 142, 142, 142, 141, 140, 139, 139, 139, 138, 138, 137, 137, 137, 136, 136, 136, 135, 134, 135, 134, 134, 134, 132, 133, 132, 132, 133, 132, 131, 131, 131, 131, 132, 132, 132, 131, 132, 132, 132, 131, 132, 132, 132, 132, 133, 132, 132, 133, 133, 134, 133, 134, 134, 134, 134, 135, 135, 136, 137, 136, 136, 137, 138, 139, 139, 140, 140, 140, 142, 141, 142, 143, 145, 145, 146, 148, 148, 150, 152, 153, 154, 156, 157, 160, 163, 163, 166, 171, 175, 179, 256, 257, 256, 256, 257, 256, 256, 257, 256, 256, 257, 257, 256, 256, 256, 257, 257, 256, 256, 257, 257, 257, 256, 257, 257, 256, 257, 257, 258, 258, 257, 257, 257, 257, 257, 257, 257, 257, 258, 257, 257, 257, 257, 257, 257, 257, 257, 258, 257, 257, 256, 257, 258, 258, 257, 257, 185, 176, 171, 168, 165, 162, 161, 160, 157, 156, 155, 153, 153, 152, 150, 149, 149, 148, 147, 146, 145, 143, 143, 143, 141, 141, 140, 139, 140, 140, 139, 138, 138, 138, 137, 136, 137, 136, 136, 136, 135, 135, 136, 135, 134, 134, 135, 134, 134, 134, 134, 134, 134, 134, 134, 134, 134, 135, 133, 133, 135, 135, 135, 134, 135, 135, 136, 136, 135, 136, 137, 137, 137, 137, 138, 138, 139, 139, 140, 141, 141, 141, 141, 143, 143, 143, 144, 145, 145, 146, 148, 149, 150, 151, 151, 152, 154, 155, 156, 158, 161, 164, 165, 166, 170, 173, 182, 261, 261, 261, 262, 261, 261, 260, 260, 261, 261, 261, 261, 261, 262, 261, 261, 262, 261, 261, 261, 262, 262, 261, 262, 262, 262, 260, 263, 261, 262, 262, 262, 262, 262, 262, 262, 263, 263, 262, 263, 262, 263, 264, 263, 263, 263, 264, 264, 263, 263, 264, 264, 263, 262, 263, 263, 263, 264, 264, 263, 264, 263, 262, 263, 263, 188, 184, 179, 177, 175, 172, 171, 171, 172, 173, 168, 162, 160, 160, 157, 157, 157, 156, 154, 154, 153, 153, 152, 151, 151, 151, 151, 148, 148, 148, 147, 147, 147, 147, 146, 146, 146, 146, 146, 145, 144, 144, 144, 144, 144, 143, 144, 144, 144, 144, 144, 143, 143, 143, 144, 144, 144, 145, 143, 144, 144, 145, 145, 145, 145, 146, 146, 145]]
centerX, centerY = 2083, 1509
radPlot, boundaryCoords = fromScratch.coreRadiusPlotter(centerX, centerY, maskedImage)
###Testing coreRadFinder
#print(fromScratch.coreRadFinder(radPlot, capEdges))

####Testing roughCapExcluder and edge showing
plt.plot(radPlot[0], radPlot[1])
plt.show()

plt.scatter(boundaryCoords[0], boundaryCoords[1])
plt.axis('equal')
plt.show()

#radPlot = fromScratch.roughCapExcluder(radPlot)
#plt.plot(radPlot[0], radPlot[1], "x")
#plt.show()


###Testing capEdge0er and checkCapEdges and gapCenter finder
capEdges = fromScratch.capEdge0er(capEdges)
testResult = fromScratch.checkCapEdges(capEdges)
gapCenters = fromScratch.gapCenters(capEdges)
capAngles, capGaps = fromScratch.getCapAngles(capEdges)

noCapRadPlot = fromScratch.capExcluder(radPlot, capEdges)

coreRad = fromScratch.coreRadFinder(noCapRadPlot, capEdges)
guidingCoreRad = fromScratch.coreRadFinder(radPlot, capAngles)

#print(capAngles, coreRad, guidingCoreRad)
#plt.plot(radPlot[0], radPlot[1])
#plt.show()

###Testing capillary radius plotting
ax = fromScratch.plotPolarLinesPLOT(centerX,centerY,capAngles,maskedImage,capGaps)
#tempPlot.plot()
#plt.show(ax)
#PIL.Image.fromarray(tempPlot).show()


capCenterCoords = fromScratch.getCapCenterCoords(capAngles, coreRad, guidingCoreRad)
#print(capCenterCoords)

capRadPlots = []
for i in range(0,len(capAngles)):
    capRadPlots.append(fromScratch.coreRadiusPlotter(capCenterCoords[i][0]+centerX, capCenterCoords[i][1]+centerY, maskedImage,100))    
    
    plt.plot(capRadPlots[i][0], capRadPlots[i][1])

plt.title("Capillary Radius plot")
plt.show()


for i in range(0,len(capCenterCoords)):
    print((int(capCenterCoords[i][0]), int(capCenterCoords[i][1])))
    
    ax.add_patch(plt.Circle((int(capCenterCoords[i][0]), int(capCenterCoords[i][1])), 20, color='r'))

plt.title("Capillary centers")
plt.show(ax)



capDepths = fromScratch.capDepths(capAngles, gapCenters, radPlot)

print(capDepths)

###Testing using manual center finder
maskedImage = cv2.imread("Kflat.jpg",0)
maskedImage = CallableMasker.main(maskedImage)

centerX, centerY = manualCenterFinder.main(maskedImage)
print(centerX, centerY)
radPlot, coreBoundCoords = fromScratch.coreRadiusPlotter(centerX, centerY, maskedImage, 1000)
plt.plot(radPlot[0], radPlot[1])

###Testing recalulating center with caps
noCapRadPlot = fromScratch.roughCapExcluder(radPlot)
sinParams = plotFitting.fitSinFunc(noCapRadPlot)
centerX, centerY = fromScratch.reCenter(centerX, centerY, sinParams)
radPlot, coreBoundCoords = fromScratch.coreRadiusPlotter(centerX, centerY, maskedImage, 1000)
plt.plot(radPlot[0], radPlot[1])

###Capillary finding before spike removal
#smoothedRads, grads = fromScratch.smoothRadsAndFindGrads(radPlot)
#plt.plot(grads[0], grads[1])
#plt.show()
#capEdges = CallableGUICapFinder2.main(smoothedRads, grads, maskedImage, centerX, centerY)
#print(capEdges)

###Testing radplot despiker
radPlot = fromScratch.despiker(radPlot)

plt.plot(radPlot[0], radPlot[1])
plt.show()

###Capillary finding after spike removal
smoothedRads, grads = fromScratch.smoothRadsAndFindGrads(radPlot)
plt.plot(grads[0], grads[1])
plt.show()
capEdges = CallableGUICapFinder2.main(smoothedRads, grads, maskedImage, centerX, centerY)
print(capEdges)


###Despiker on capillary radius plots
capRadPlots = [[[0.0, 0.06283185307179587, 0.12566370614359174, 0.18849555921538758, 0.25132741228718347, 0.3141592653589793, 0.37699111843077515, 0.43982297150257105, 0.5026548245743669, 0.5654866776461628, 0.6283185307179586, 0.6911503837897545, 0.7539822368615503, 0.8168140899333463, 0.8796459430051421, 0.9424777960769378, 1.0053096491487339, 1.0681415022205298, 1.1309733552923256, 1.1938052083641213, 1.2566370614359172, 1.3194689145077132, 1.382300767579509, 1.4451326206513047, 1.5079644737231006, 1.5707963267948966, 1.6336281798666925, 1.6964600329384882, 1.7592918860102842, 1.8221237390820801, 1.8849555921538756, 1.9477874452256716, 2.0106192982974678, 2.0734511513692637, 2.1362830044410597, 2.199114857512855, 2.261946710584651, 2.324778563656447, 2.3876104167282426, 2.4504422698000385, 2.5132741228718345, 2.57610597594363, 2.6389378290154264, 2.701769682087222, 2.764601535159018, 2.827433388230814, 2.8902652413026093, 2.9530970943744057, 3.015928947446201, 3.078760800517997, 3.141592653589793, 3.204424506661589, 3.267256359733385, 3.330088212805181, 3.3929200658769765, 3.4557519189487724, 3.5185837720205684, 3.581415625092364, 3.6442474781641603, 3.707079331235956, 3.7699111843077513, 3.8327430373795477, 3.895574890451343, 3.9584067435231396, 4.0212385965949355, 4.084070449666731, 4.1469023027385274, 4.209734155810323, 4.272566008882119, 4.335397861953915, 4.39822971502571, 4.461061568097507, 4.523893421169302, 4.586725274241098, 4.649557127312894, 4.71238898038469, 4.775220833456485, 4.838052686528282, 4.900884539600077, 4.9637163926718735, 5.026548245743669, 5.0893800988154645, 5.15221195188726, 5.215043804959057, 5.277875658030853, 5.340707511102648, 5.403539364174444, 5.466371217246239, 5.529203070318036, 5.592034923389832, 5.654866776461628, 5.717698629533423, 5.780530482605219, 5.843362335677015, 5.906194188748811, 5.969026041820607, 6.031857894892402, 6.094689747964199, 6.157521601035994, 6.220353454107791], [159, 12, 12, 146, 142, 7, 7, 7, 36, 124, 115, 116, 117, 122, 120, 118, 36, 116, 117, 114, 120, 121, 127, 130, 133, 9, 9, 156, 162, 169, 14, 33, 204, 213, 221, 228, 34, 34, 238, 237, 234, 228, 11, 73, 29, 23, 169, 17, 31, 41, 86, 45, 24, 24, 26, 81, 46, 60, 51, 26, 18, 18, 34, 68, 48, 8, 8, 34, 30, 55, 19, 29, 23, 19, 18, 60, 25, 43, 14, 12, 12, 13, 13, 28, 24, 12, 11, 11, 11, 210, 25, 7, 7, 26, 220, 220, 216, 217, 203, 178]], [[0.0, 0.06283185307179587, 0.12566370614359174, 0.18849555921538758, 0.25132741228718347, 0.3141592653589793, 0.37699111843077515, 0.43982297150257105, 0.5026548245743669, 0.5654866776461628, 0.6283185307179586, 0.6911503837897545, 0.7539822368615503, 0.8168140899333463, 0.8796459430051421, 0.9424777960769378, 1.0053096491487339, 1.0681415022205298, 1.1309733552923256, 1.1938052083641213, 1.2566370614359172, 1.3194689145077132, 1.382300767579509, 1.4451326206513047, 1.5079644737231006, 1.5707963267948966, 1.6336281798666925, 1.6964600329384882, 1.7592918860102842, 1.8221237390820801, 1.8849555921538756, 1.9477874452256716, 2.0106192982974678, 2.0734511513692637, 2.1362830044410597, 2.199114857512855, 2.261946710584651, 2.324778563656447, 2.3876104167282426, 2.4504422698000385, 2.5132741228718345, 2.57610597594363, 2.6389378290154264, 2.701769682087222, 2.764601535159018, 2.827433388230814, 2.8902652413026093, 2.9530970943744057, 3.015928947446201, 3.078760800517997, 3.141592653589793, 3.204424506661589, 3.267256359733385, 3.330088212805181, 3.3929200658769765, 3.4557519189487724, 3.5185837720205684, 3.581415625092364, 3.6442474781641603, 3.707079331235956, 3.7699111843077513, 3.8327430373795477, 3.895574890451343, 3.9584067435231396, 4.0212385965949355, 4.084070449666731, 4.1469023027385274, 4.209734155810323, 4.272566008882119, 4.335397861953915, 4.39822971502571, 4.461061568097507, 4.523893421169302, 4.586725274241098, 4.649557127312894, 4.71238898038469, 4.775220833456485, 4.838052686528282, 4.900884539600077, 4.9637163926718735, 5.026548245743669, 5.0893800988154645, 5.15221195188726, 5.215043804959057, 5.277875658030853, 5.340707511102648, 5.403539364174444, 5.466371217246239, 5.529203070318036, 5.592034923389832, 5.654866776461628, 5.717698629533423, 5.780530482605219, 5.843362335677015, 5.906194188748811, 5.969026041820607, 6.031857894892402, 6.094689747964199, 6.157521601035994, 6.220353454107791], [145, 162, 179, 197, 212, 228, 615, 532, 255, 255, 259, 258, 255, 250, 244, 236, 226, 216, 206, 197, 187, 178, 171, 164, 158, 151, 148, 145, 145, 143, 143, 143, 143, 143, 141, 143, 141, 145, 147, 151, 156, 163, 169, 177, 183, 192, 201, 211, 220, 228, 235, 241, 245, 247, 248, 245, 242, 236, 226, 213, 199, 182, 166, 146, 132, 120, 108, 101, 92, 86, 81, 76, 73, 72, 69, 67, 65, 63, 63, 62, 61, 61, 61, 61, 62, 62, 63, 64, 66, 68, 70, 73, 77, 81, 84, 90, 99, 106, 116, 131]], [[0.0, 0.06283185307179587, 0.12566370614359174, 0.18849555921538758, 0.25132741228718347, 0.3141592653589793, 0.37699111843077515, 0.43982297150257105, 0.5026548245743669, 0.5654866776461628, 0.6283185307179586, 0.6911503837897545, 0.7539822368615503, 0.8168140899333463, 0.8796459430051421, 0.9424777960769378, 1.0053096491487339, 1.0681415022205298, 1.1309733552923256, 1.1938052083641213, 1.2566370614359172, 1.3194689145077132, 1.382300767579509, 1.4451326206513047, 1.5079644737231006, 1.5707963267948966, 1.6336281798666925, 1.6964600329384882, 1.7592918860102842, 1.8221237390820801, 1.8849555921538756, 1.9477874452256716, 2.0106192982974678, 2.0734511513692637, 2.1362830044410597, 2.199114857512855, 2.261946710584651, 2.324778563656447, 2.3876104167282426, 2.4504422698000385, 2.5132741228718345, 2.57610597594363, 2.6389378290154264, 2.701769682087222, 2.764601535159018, 2.827433388230814, 2.8902652413026093, 2.9530970943744057, 3.015928947446201, 3.078760800517997, 3.141592653589793, 3.204424506661589, 3.267256359733385, 3.330088212805181, 3.3929200658769765, 3.4557519189487724, 3.5185837720205684, 3.581415625092364, 3.6442474781641603, 3.707079331235956, 3.7699111843077513, 3.8327430373795477, 3.895574890451343, 3.9584067435231396, 4.0212385965949355, 4.084070449666731, 4.1469023027385274, 4.209734155810323, 4.272566008882119, 4.335397861953915, 4.39822971502571, 4.461061568097507, 4.523893421169302, 4.586725274241098, 4.649557127312894, 4.71238898038469, 4.775220833456485, 4.838052686528282, 4.900884539600077, 4.9637163926718735, 5.026548245743669, 5.0893800988154645, 5.15221195188726, 5.215043804959057, 5.277875658030853, 5.340707511102648, 5.403539364174444, 5.466371217246239, 5.529203070318036, 5.592034923389832, 5.654866776461628, 5.717698629533423, 5.780530482605219, 5.843362335677015, 5.906194188748811, 5.969026041820607, 6.031857894892402, 6.094689747964199, 6.157521601035994, 6.220353454107791], [91, 90, 90, 90, 91, 91, 93, 94, 95, 98, 102, 107, 112, 117, 123, 132, 142, 152, 171, 180, 191, 204, 215, 222, 232, 234, 237, 236, 233, 224, 215, 207, 198, 187, 171, 159, 156, 144, 137, 127, 122, 116, 111, 108, 103, 101, 99, 99, 95, 95, 94, 95, 95, 97, 96, 94, 99, 104, 103, 105, 107, 111, 112, 116, 122, 127, 134, 144, 157, 169, 182, 194, 209, 221, 232, 237, 242, 244, 244, 242, 238, 230, 223, 210, 196, 183, 170, 155, 143, 134, 127, 118, 113, 108, 103, 101, 98, 95, 93, 92]], [[0.0, 0.06283185307179587, 0.12566370614359174, 0.18849555921538758, 0.25132741228718347, 0.3141592653589793, 0.37699111843077515, 0.43982297150257105, 0.5026548245743669, 0.5654866776461628, 0.6283185307179586, 0.6911503837897545, 0.7539822368615503, 0.8168140899333463, 0.8796459430051421, 0.9424777960769378, 1.0053096491487339, 1.0681415022205298, 1.1309733552923256, 1.1938052083641213, 1.2566370614359172, 1.3194689145077132, 1.382300767579509, 1.4451326206513047, 1.5079644737231006, 1.5707963267948966, 1.6336281798666925, 1.6964600329384882, 1.7592918860102842, 1.8221237390820801, 1.8849555921538756, 1.9477874452256716, 2.0106192982974678, 2.0734511513692637, 2.1362830044410597, 2.199114857512855, 2.261946710584651, 2.324778563656447, 2.3876104167282426, 2.4504422698000385, 2.5132741228718345, 2.57610597594363, 2.6389378290154264, 2.701769682087222, 2.764601535159018, 2.827433388230814, 2.8902652413026093, 2.9530970943744057, 3.015928947446201, 3.078760800517997, 3.141592653589793, 3.204424506661589, 3.267256359733385, 3.330088212805181, 3.3929200658769765, 3.4557519189487724, 3.5185837720205684, 3.581415625092364, 3.6442474781641603, 3.707079331235956, 3.7699111843077513, 3.8327430373795477, 3.895574890451343, 3.9584067435231396, 4.0212385965949355, 4.084070449666731, 4.1469023027385274, 4.209734155810323, 4.272566008882119, 4.335397861953915, 4.39822971502571, 4.461061568097507, 4.523893421169302, 4.586725274241098, 4.649557127312894, 4.71238898038469, 4.775220833456485, 4.838052686528282, 4.900884539600077, 4.9637163926718735, 5.026548245743669, 5.0893800988154645, 5.15221195188726, 5.215043804959057, 5.277875658030853, 5.340707511102648, 5.403539364174444, 5.466371217246239, 5.529203070318036, 5.592034923389832, 5.654866776461628, 5.717698629533423, 5.780530482605219, 5.843362335677015, 5.906194188748811, 5.969026041820607, 6.031857894892402, 6.094689747964199, 6.157521601035994, 6.220353454107791], [205, 191, 179, 165, 157, 148, 141, 135, 129, 123, 119, 116, 113, 112, 110, 109, 109, 109, 110, 109, 112, 113, 116, 119, 123, 128, 132, 138, 147, 157, 167, 177, 187, 199, 210, 222, 229, 237, 240, 244, 242, 238, 237, 231, 225, 217, 205, 192, 181, 170, 160, 150, 142, 133, 125, 120, 116, 114, 109, 104, 99, 95, 95, 93, 93, 93, 92, 94, 94, 96, 98, 99, 102, 102, 103, 105, 108, 112, 117, 122, 130, 139, 149, 158, 173, 185, 205, 212, 223, 235, 239, 246, 250, 252, 249, 248, 241, 235, 227, 216]], [[0.0, 0.06283185307179587, 0.12566370614359174, 0.18849555921538758, 0.25132741228718347, 0.3141592653589793, 0.37699111843077515, 0.43982297150257105, 0.5026548245743669, 0.5654866776461628, 0.6283185307179586, 0.6911503837897545, 0.7539822368615503, 0.8168140899333463, 0.8796459430051421, 0.9424777960769378, 1.0053096491487339, 1.0681415022205298, 1.1309733552923256, 1.1938052083641213, 1.2566370614359172, 1.3194689145077132, 1.382300767579509, 1.4451326206513047, 1.5079644737231006, 1.5707963267948966, 1.6336281798666925, 1.6964600329384882, 1.7592918860102842, 1.8221237390820801, 1.8849555921538756, 1.9477874452256716, 2.0106192982974678, 2.0734511513692637, 2.1362830044410597, 2.199114857512855, 2.261946710584651, 2.324778563656447, 2.3876104167282426, 2.4504422698000385, 2.5132741228718345, 2.57610597594363, 2.6389378290154264, 2.701769682087222, 2.764601535159018, 2.827433388230814, 2.8902652413026093, 2.9530970943744057, 3.015928947446201, 3.078760800517997, 3.141592653589793, 3.204424506661589, 3.267256359733385, 3.330088212805181, 3.3929200658769765, 3.4557519189487724, 3.5185837720205684, 3.581415625092364, 3.6442474781641603, 3.707079331235956, 3.7699111843077513, 3.8327430373795477, 3.895574890451343, 3.9584067435231396, 4.0212385965949355, 4.084070449666731, 4.1469023027385274, 4.209734155810323, 4.272566008882119, 4.335397861953915, 4.39822971502571, 4.461061568097507, 4.523893421169302, 4.586725274241098, 4.649557127312894, 4.71238898038469, 4.775220833456485, 4.838052686528282, 4.900884539600077, 4.9637163926718735, 5.026548245743669, 5.0893800988154645, 5.15221195188726, 5.215043804959057, 5.277875658030853, 5.340707511102648, 5.403539364174444, 5.466371217246239, 5.529203070318036, 5.592034923389832, 5.654866776461628, 5.717698629533423, 5.780530482605219, 5.843362335677015, 5.906194188748811, 5.969026041820607, 6.031857894892402, 6.094689747964199, 6.157521601035994, 6.220353454107791], [207, 218, 229, 239, 248, 254, 257, 259, 258, 255, 251, 244, 235, 225, 213, 199, 186, 172, 160, 151, 140, 132, 126, 120, 116, 111, 109, 105, 104, 101, 100, 99, 99, 99, 100, 101, 101, 103, 105, 108, 112, 115, 122, 126, 134, 142, 150, 162, 175, 188, 201, 214, 226, 236, 243, 250, 253, 256, 255, 253, 248, 241, 231, 220, 208, 197, 184, 175, 164, 153, 145, 138, 132, 127, 122, 119, 116, 114, 112, 111, 111, 110, 111, 112, 114, 114, 114, 114, 116, 118, 121, 124, 129, 135, 142, 151, 161, 173, 183, 195]], [[0.0, 0.06283185307179587, 0.12566370614359174, 0.18849555921538758, 0.25132741228718347, 0.3141592653589793, 0.37699111843077515, 0.43982297150257105, 0.5026548245743669, 0.5654866776461628, 0.6283185307179586, 0.6911503837897545, 0.7539822368615503, 0.8168140899333463, 0.8796459430051421, 0.9424777960769378, 1.0053096491487339, 1.0681415022205298, 1.1309733552923256, 1.1938052083641213, 1.2566370614359172, 1.3194689145077132, 1.382300767579509, 1.4451326206513047, 1.5079644737231006, 1.5707963267948966, 1.6336281798666925, 1.6964600329384882, 1.7592918860102842, 1.8221237390820801, 1.8849555921538756, 1.9477874452256716, 2.0106192982974678, 2.0734511513692637, 2.1362830044410597, 2.199114857512855, 2.261946710584651, 2.324778563656447, 2.3876104167282426, 2.4504422698000385, 2.5132741228718345, 2.57610597594363, 2.6389378290154264, 2.701769682087222, 2.764601535159018, 2.827433388230814, 2.8902652413026093, 2.9530970943744057, 3.015928947446201, 3.078760800517997, 3.141592653589793, 3.204424506661589, 3.267256359733385, 3.330088212805181, 3.3929200658769765, 3.4557519189487724, 3.5185837720205684, 3.581415625092364, 3.6442474781641603, 3.707079331235956, 3.7699111843077513, 3.8327430373795477, 3.895574890451343, 3.9584067435231396, 4.0212385965949355, 4.084070449666731, 4.1469023027385274, 4.209734155810323, 4.272566008882119, 4.335397861953915, 4.39822971502571, 4.461061568097507, 4.523893421169302, 4.586725274241098, 4.649557127312894, 4.71238898038469, 4.775220833456485, 4.838052686528282, 4.900884539600077, 4.9637163926718735, 5.026548245743669, 5.0893800988154645, 5.15221195188726, 5.215043804959057, 5.277875658030853, 5.340707511102648, 5.403539364174444, 5.466371217246239, 5.529203070318036, 5.592034923389832, 5.654866776461628, 5.717698629533423, 5.780530482605219, 5.843362335677015, 5.906194188748811, 5.969026041820607, 6.031857894892402, 6.094689747964199, 6.157521601035994, 6.220353454107791], [107, 107, 105, 105, 107, 110, 113, 119, 123, 129, 134, 146, 156, 163, 177, 190, 199, 213, 227, 235, 243, 246, 249, 534, 255, 241, 231, 226, 218, 207, 198, 186, 175, 165, 153, 146, 138, 131, 125, 120, 116, 113, 110, 108, 106, 105, 103, 103, 102, 103, 103, 104, 106, 108, 111, 114, 118, 122, 127, 134, 141, 149, 159, 169, 180, 193, 205, 216, 227, 234, 241, 245, 248, 249, 247, 244, 240, 232, 220, 207, 195, 183, 175, 168, 162, 153, 145, 136, 131, 126, 120, 119, 115, 113, 111, 108, 106, 107, 104, 109]]]
capCenters = [[667.3615141488452, 943.2464435900653], [-468.8618279265896, 1056.0557893528555], [-1152.9452359784802, -76.1743181582344], [-625.2433607366843, -971.6768926793732], [505.0692980503018, -1039.2257926357106], [1148.0770208408817, -130.4009130699303]]

despikedCapRadPlots = []
capOvality = []
for i in range(0,len(capRadPlots)):    
    #plt.figure(0)
    #plt.plot(capRadPlots[i][0], capRadPlots[i][1])
    
    #plt.figure(1)
    despikedTempCapRadPlot = fromScratch.despiker(capRadPlots[i])
    despikedCapRadPlots.append(despikedTempCapRadPlot)
    plt.plot(despikedTempCapRadPlot[0],despikedTempCapRadPlot[1])
    
    ###Finding ovalarity of capillaries
    #capOvality.append(fromScratch.getOvality(despikedTempCapRadPlot))
    print(stat.stdev(despikedTempCapRadPlot[1]))
    
    #Find more accurate center using core re-centerer
    sinParams = plotFitting.fitSinFunc(despikedTempCapRadPlot)
    #Show sin curve fitted to rad plots
    #sinYs = []
    #for i in range(0,len(capRadPlots[i][0])):
     #   sinYs.append()
    
    plt.plot(capRadPlots[i][0], plotFitting.sinFunc(capRadPlots[i][0], sinParams[0], sinParams[1], sinParams[2]))
    plt.show()

    print(capCenters[i][0], capCenters[i][1])
    print(fromScratch.reCenter(capCenters[i][0], capCenters[i][1], sinParams))
    
    ax = fromScratch.plotPolarLinesPLOT(dataD['centerX'],dataD['centerY'],dataD['capAngles'],dataD['maskedImage'],dataD['capGaps'])
    
    #Find more accurate capillary centers using standard deviation of radius plot
    #newCapCenters = fromScratch.recenterCaps
    

print(capOvality)

#plt.figure(0)    
#plt.title("Capillary Radius plot")
#plt.show()

#plt.figure(1)
#plt.show()


#capEdges = fromScratch.capEdge0er(capEdges)
#print(capEdges)
#plt.plot(radPlot[0], radPlot[1])
#plt.show()

#tempCaps = [[0.6660176425610361, 0], [1.3131857292005336, 1], [1.7467255153959251, 0], [2.4190263432641403, 1], [2.7520351645446586, 0], [3.436902363027233, 1], [3.782477554922111, 0], [4.467344753404686, 1], [4.819203130606742, 0], [5.497787143782138, 1], [5.893627818134452, 0], [0.26389378290154264, 1]]
#print(tempCaps[2][0])
#print(fromScratch.adjacentCaps(4.0, capEdges))

noCapRadPlot = fromScratch.capExcluder(radPlot, capEdges)
sinParams = plotFitting.fitSinFunc(noCapRadPlot)

plt.plot(noCapRadPlot[0], noCapRadPlot[1], 'x', linestyle='None')
plt.plot(radPlot[0], plotFitting.sinFunc(radPlot[0], sinParams[0], sinParams[1], sinParams[2]))
plt.show()

newCenterX, newCenterY = fromScratch.reCenter(centerX, centerY, sinParams)

print (newCenterX, newCenterY)

centeredRadPlot = fromScratch.coreRadiusPlotter(newCenterX, newCenterY, maskedImage)
plt.plot(centeredRadPlot[0], centeredRadPlot[1])
plt.show()
'''
